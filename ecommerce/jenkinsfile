pipeline {
  agent any

  parameters {
    booleanParam(name: 'CLEANUP_AFTER', defaultValue: true, description: 'Clean up after job?')
  }


  stages {
        stage('Prep Workspace') {
          steps {
            deleteDir()
          }
        }
         stage('Run') {
            steps {
            sh '''
                  echo "Cloning repo..."
                  git clone https://github.com/ashishmishra36/learnings.git

                  echo "Setting up Python venv..."
                  python3 -m venv venv
                  . venv/bin/activate

                  echo "Installing dependencies..."
                  pip3 install -r requirements.txt

                  echo "Running tests..."
                  pytest ecommerce/tests --html=reports/report.html
                '''
            }
     }
  }
}
