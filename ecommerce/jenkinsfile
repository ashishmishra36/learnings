pipeline {
  agent any

  parameters {
    booleanParam(name: 'CLEANUP_AFTER', defaultValue: true, description: 'Clean up after job?')
  }


  stages {

         stage('Run') {
            steps {
            dir('learnings'){
                    sh '''
                      echo "Setting up Python venv..."
                      python3 -m venv venv
                      . venv/bin/activate

                      echo "Installing dependencies..."
                      pip3 install -r requirements.txt

                      echo "Running tests..."
                      ./venv/bin/pytest ecommerce/tests --html=reports/report.html
                    '''
                }
            }
     }
  }
}
